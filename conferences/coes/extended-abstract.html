<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Meritocracia en la etapa escolar: una validación y aplicación de una escala sobre percepciones y preferencias de meritocracia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="extended-abstract_files/libs/clipboard/clipboard.min.js"></script>
<script src="extended-abstract_files/libs/quarto-html/quarto.js"></script>
<script src="extended-abstract_files/libs/quarto-html/popper.min.js"></script>
<script src="extended-abstract_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="extended-abstract_files/libs/quarto-html/anchor.min.js"></script>
<link href="extended-abstract_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="extended-abstract_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="extended-abstract_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="extended-abstract_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="extended-abstract_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Meritocracia en la etapa escolar: una validación y aplicación de una escala sobre percepciones y preferencias de meritocracia</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El aumento de la desigualdad económica y la concentración de la riqueza se ha asociado con una creciente preocupación por estudiar sus implicancias subjetivas. Las creencias de que las sociedades operan y distribuyen las recompensas en función de principios meritocráticos—donde las disparidades económicas se justifican por diferencias en esfuerzo y talento individual— han sido identificadas como uno los mecanismos claves para explicar la persistencia de las desigualdades. Ante los desafíos asociados con las diferentes conceptualizaciones y mediciones de la meritocracia, Castillo et al.&nbsp;(2023) proponen un marco conceptual y de medición para evaluar las percepciones y preferencias meritocráticas y no meritocráticas en contextos de encuestas. Este estudio pretende probar la validez y aplicabilidad de esta propuesta de escala en población escolar en Chile. A partir de los datos de la Encuesta Panel Educación y Meritocracia en sus olas de 2023 (N = 804) y 2024 (N = X) para estudiantes, estimamos análisis factoriales confirmatorios (CFA), pruebas de invariancia y modelos de ecuaciones estructurales. Los resultados preliminares indican que la escala presenta buenos indicadores de ajuste y que sus dimensiones se corresponden con el modelo conceptual multidimensional propuesto, con altas contribuciones factoriales de sus ítems. Con el análisis de invarianza encontramos evidencia que respalda la equivalencia y aplicabilidad de la escala en diferentes muestras medidas en dos puntos de tiempo. Adicionalmente, los modelos de ecuaciones estructurales muestran que la escala predice actitudes políticas en la manera esperada por la evidencia previa, sugiriendo su validez de criterio. Estos hallazgos contribuyen tanto al desarrollo de la medición de la meritocracia y la no meritocracia como a la investigación empírica que examina su relación con diversas actitudes políticas en la etapa escolar en Chile.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="extended-abstract_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="extended-abstract_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>m2_cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> model_cfa, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> db, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">estimator =</span> <span class="st">"DWLS"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">ordered =</span> T,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">std.lv =</span> F)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_cfa, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T, <span class="at">rsquare =</span> T, <span class="at">modindices =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 44 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        38

  Number of observations                           846

Model Test User Model:
                                                      
  Test statistic                                40.288
  Degrees of freedom                                14
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              2455.928
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.989
  Tucker-Lewis Index (TLI)                       0.978

Root Mean Square Error of Approximation:

  RMSEA                                          0.047
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.064
  P-value H_0: RMSEA &lt;= 0.050                    0.579
  P-value H_0: RMSEA &gt;= 0.080                    0.001

Standardized Root Mean Square Residual:

  SRMR                                           0.038

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perc_merit =~                                                         
    perc_effort       1.000                               0.870    0.870
    perc_talent       0.692    0.218    3.171    0.002    0.602    0.602
  perc_nmerit =~                                                        
    perc_rch_prnts    1.000                               0.649    0.649
    perc_contact      1.452    0.194    7.501    0.000    0.943    0.943
  pref_merit =~                                                         
    pref_effort       1.000                               0.605    0.605
    pref_talent       0.977    0.152    6.425    0.000    0.591    0.591
  pref_nmerit =~                                                        
    pref_rch_prnts    1.000                               0.738    0.738
    pref_contact      1.129    0.187    6.047    0.000    0.833    0.833

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  perc_merit ~~                                                         
    perc_nmerit      -0.075    0.019   -3.910    0.000   -0.133   -0.133
    pref_merit        0.033    0.022    1.483    0.138    0.063    0.063
    pref_nmerit       0.096    0.024    4.026    0.000    0.150    0.150
  perc_nmerit ~~                                                        
    pref_merit        0.181    0.027    6.697    0.000    0.461    0.461
    pref_nmerit       0.133    0.022    6.018    0.000    0.277    0.277
  pref_merit ~~                                                         
    pref_nmerit       0.083    0.021    3.966    0.000    0.186    0.186

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .perc_effort       0.000                               0.000    0.000
   .perc_talent       0.000                               0.000    0.000
   .perc_rch_prnts    0.000                               0.000    0.000
   .perc_contact      0.000                               0.000    0.000
   .pref_effort       0.000                               0.000    0.000
   .pref_talent       0.000                               0.000    0.000
   .pref_rch_prnts    0.000                               0.000    0.000
   .pref_contact      0.000                               0.000    0.000
    perc_merit        0.000                               0.000    0.000
    perc_nmerit       0.000                               0.000    0.000
    pref_merit        0.000                               0.000    0.000
    pref_nmerit       0.000                               0.000    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perc_effort|t1   -1.046    0.053  -19.780    0.000   -1.046   -1.046
    perc_effort|t2    0.437    0.045    9.793    0.000    0.437    0.437
    perc_effort|t3    1.562    0.069   22.672    0.000    1.562    1.562
    perc_talent|t1   -0.977    0.051  -18.972    0.000   -0.977   -0.977
    perc_talent|t2    0.625    0.046   13.495    0.000    0.625    0.625
    perc_talent|t3    1.572    0.069   22.674    0.000    1.572    1.572
    prc_rch_prnt|1   -0.301    0.044   -6.862    0.000   -0.301   -0.301
    prc_rch_prnt|2    0.565    0.046   12.359    0.000    0.565    0.565
    prc_rch_prnt|3    1.395    0.062   22.345    0.000    1.395    1.395
    perc_contct|t1   -0.418    0.045   -9.386    0.000   -0.418   -0.418
    perc_contct|t2    0.745    0.048   15.599    0.000    0.745    0.745
    perc_contct|t3    1.615    0.071   22.659    0.000    1.615    1.615
    pref_effort|t1    0.101    0.043    2.336    0.019    0.101    0.101
    pref_effort|t2    1.172    0.056   21.002    0.000    1.172    1.172
    pref_effort|t3    1.762    0.079   22.340    0.000    1.762    1.762
    pref_talent|t1   -0.982    0.052  -19.031    0.000   -0.982   -0.982
    pref_talent|t2    0.116    0.043    2.680    0.007    0.116    0.116
    pref_talent|t3    1.427    0.064   22.452    0.000    1.427    1.427
    prf_rch_prnt|1   -1.364    0.061  -22.222    0.000   -1.364   -1.364
    prf_rch_prnt|2    0.110    0.043    2.542    0.011    0.110    0.110
    prf_rch_prnt|3    1.306    0.060   21.936    0.000    1.306    1.306
    pref_contct|t1   -1.115    0.054  -20.490    0.000   -1.115   -1.115
    pref_contct|t2    0.276    0.044    6.314    0.000    0.276    0.276
    pref_contct|t3    1.379    0.062   22.285    0.000    1.379    1.379

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .perc_effort       0.244                               0.244    0.244
   .perc_talent       0.638                               0.638    0.638
   .perc_rch_prnts    0.579                               0.579    0.579
   .perc_contact      0.112                               0.112    0.112
   .pref_effort       0.634                               0.634    0.634
   .pref_talent       0.651                               0.651    0.651
   .pref_rch_prnts    0.456                               0.456    0.456
   .pref_contact      0.307                               0.307    0.307
    perc_merit        0.756    0.241    3.136    0.002    1.000    1.000
    perc_nmerit       0.421    0.059    7.194    0.000    1.000    1.000
    pref_merit        0.366    0.067    5.499    0.000    1.000    1.000
    pref_nmerit       0.544    0.092    5.927    0.000    1.000    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    perc_effort       1.000                               1.000    1.000
    perc_talent       1.000                               1.000    1.000
    perc_rch_prnts    1.000                               1.000    1.000
    perc_contact      1.000                               1.000    1.000
    pref_effort       1.000                               1.000    1.000
    pref_talent       1.000                               1.000    1.000
    pref_rch_prnts    1.000                               1.000    1.000
    pref_contact      1.000                               1.000    1.000

R-Square:
                   Estimate
    perc_effort       0.756
    perc_talent       0.362
    perc_rch_prnts    0.421
    perc_contact      0.888
    pref_effort       0.366
    pref_talent       0.349
    pref_rch_prnts    0.544
    pref_contact      0.693

Modification Indices:

                 lhs op               rhs     mi    epc sepc.lv sepc.all
1         perc_merit =~ perc_rich_parents  8.780 -0.137  -0.119   -0.119
2         perc_merit =~      perc_contact  8.780  0.200   0.174    0.174
3         perc_merit =~       pref_effort  1.029  0.058   0.050    0.050
4         perc_merit =~       pref_talent  1.029 -0.057  -0.049   -0.049
5         perc_merit =~ pref_rich_parents  0.107 -0.018  -0.015   -0.015
6         perc_merit =~      pref_contact  0.107  0.020   0.017    0.017
7        perc_nmerit =~       perc_effort 15.076 -0.328  -0.213   -0.213
8        perc_nmerit =~       perc_talent 15.076  0.227   0.147    0.147
9        perc_nmerit =~       pref_effort  0.280 -0.143  -0.093   -0.093
10       perc_nmerit =~       pref_talent  0.280  0.139   0.090    0.090
11       perc_nmerit =~ pref_rich_parents  0.132  0.042   0.027    0.027
12       perc_nmerit =~      pref_contact  0.132 -0.047  -0.031   -0.031
13        pref_merit =~       perc_effort 19.310 -0.466  -0.282   -0.282
14        pref_merit =~       perc_talent 19.310  0.322   0.195    0.195
15        pref_merit =~ perc_rich_parents  0.305 -0.088  -0.053   -0.053
16        pref_merit =~      perc_contact  0.305  0.128   0.077    0.077
17        pref_merit =~ pref_rich_parents  0.021 -0.020  -0.012   -0.012
18        pref_merit =~      pref_contact  0.021  0.023   0.014    0.014
19       pref_nmerit =~       perc_effort  7.210 -0.235  -0.173   -0.173
20       pref_nmerit =~       perc_talent  7.210  0.163   0.120    0.120
21       pref_nmerit =~ perc_rich_parents  7.017 -0.182  -0.134   -0.134
22       pref_nmerit =~      perc_contact  7.017  0.265   0.195    0.195
23       pref_nmerit =~       pref_effort  2.385 -0.123  -0.091   -0.091
24       pref_nmerit =~       pref_talent  2.385  0.121   0.089    0.089
25       perc_effort ~~ perc_rich_parents 10.934 -0.134  -0.134   -0.357
26       perc_effort ~~      perc_contact  0.224  0.025   0.025    0.154
27       perc_effort ~~       pref_effort  0.356 -0.029  -0.029   -0.073
28       perc_effort ~~       pref_talent  7.685 -0.124  -0.124   -0.312
29       perc_effort ~~ pref_rich_parents  1.702 -0.063  -0.063   -0.189
30       perc_effort ~~      pref_contact  0.005 -0.004  -0.004   -0.013
31       perc_talent ~~ perc_rich_parents  0.064  0.011   0.011    0.018
32       perc_talent ~~      perc_contact  9.609  0.149   0.149    0.559
33       perc_talent ~~       pref_effort  7.266  0.117   0.117    0.184
34       perc_talent ~~       pref_talent  3.092  0.070   0.070    0.109
35       perc_talent ~~ pref_rich_parents  1.652  0.056   0.056    0.105
36       perc_talent ~~      pref_contact  0.236  0.022   0.022    0.051
37 perc_rich_parents ~~       pref_effort  1.143  0.058   0.058    0.095
38 perc_rich_parents ~~       pref_talent  0.217 -0.024  -0.024   -0.039
39 perc_rich_parents ~~ pref_rich_parents  0.597  0.035   0.035    0.068
40 perc_rich_parents ~~      pref_contact  9.984 -0.149  -0.149   -0.353
41      perc_contact ~~       pref_effort  0.062 -0.018  -0.018   -0.068
42      perc_contact ~~       pref_talent  0.083 -0.020  -0.020   -0.073
43      perc_contact ~~ pref_rich_parents  0.094 -0.017  -0.017   -0.077
44      perc_contact ~~      pref_contact  5.732  0.141   0.141    0.763
45       pref_effort ~~ pref_rich_parents  1.032 -0.049  -0.049   -0.092
46       pref_effort ~~      pref_contact  1.063 -0.051  -0.051   -0.116
47       pref_talent ~~ pref_rich_parents  0.385  0.027   0.027    0.049
48       pref_talent ~~      pref_contact  1.462  0.053   0.053    0.119
   sepc.nox
1    -0.119
2     0.174
3     0.050
4    -0.049
5    -0.015
6     0.017
7    -0.213
8     0.147
9    -0.093
10    0.090
11    0.027
12   -0.031
13   -0.282
14    0.195
15   -0.053
16    0.077
17   -0.012
18    0.014
19   -0.173
20    0.120
21   -0.134
22    0.195
23   -0.091
24    0.089
25   -0.357
26    0.154
27   -0.073
28   -0.312
29   -0.189
30   -0.013
31    0.018
32    0.559
33    0.184
34    0.109
35    0.105
36    0.051
37    0.095
38   -0.039
39    0.068
40   -0.353
41   -0.068
42   -0.073
43   -0.077
44    0.763
45   -0.092
46   -0.116
47    0.049
48    0.119</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>